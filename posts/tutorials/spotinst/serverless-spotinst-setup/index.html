<!doctype html><html lang=en><head><title>Deploy functions on Spotinst using Serverless Framework :: Notes</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Spotinst is one of the providers which support deploying serverless functions or FaaS (Function as a Service)."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://abskmj.github.io/notes/posts/tutorials/spotinst/serverless-spotinst-setup/><link rel=stylesheet href=https://abskmj.github.io/notes/styles.css><link rel="shortcut icon" href="https://avatars.githubusercontent.com/u/29548356?s=32&amp;v=4"><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Deploy functions on Spotinst using Serverless Framework"><meta property="og:description" content="Spotinst is one of the providers which support deploying serverless functions or FaaS (Function as a Service)."><meta property="og:url" content="https://abskmj.github.io/notes/posts/tutorials/spotinst/serverless-spotinst-setup/"><meta property="og:site_name" content="Notes"><meta property="og:image" content="https://avatars.githubusercontent.com/u/29548356?s=32&amp;v=4"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:published_time" content="2019-01-08 09:56:04 +0000 UTC"><link rel=apple-touch-icon sizes=180x180 href=/notes/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/notes/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/notes/favicon-16x16.png><link rel=manifest href=/notes/site.webmanifest><meta name=google-site-verification content="f4QUPyqBnCYP57-SME_dv0q-Di8xwBAOMIhlBGeVWJY"><script async src="https://www.googletagmanager.com/gtag/js?id=G-CMVNGMLVMF"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-CMVNGMLVMF")</script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "aa73cbf1591c45448ff0b2735f97bb74"}'></script></head><body class=green><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/notes><div class=logo>Notes</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=https://discordapp.com/users/220585271983472650>Discord</a></li><li><a href=mailto:contact.abskmj@gmail.com>Email</a></li><li><a href=https://github.com/abskmj>Github</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=https://discordapp.com/users/220585271983472650>Discord</a></li><li><a href=mailto:contact.abskmj@gmail.com>Email</a></li><li><a href=https://github.com/abskmj>Github</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://abskmj.github.io/notes/posts/tutorials/spotinst/serverless-spotinst-setup/>Deploy functions on Spotinst using Serverless Framework</a></h1><div class=post-meta><time class=post-date>2019-01-08</time></div><span class=post-tags>#<a href=https://abskmj.github.io/notes/tags/spotinst/>Spotinst</a>&nbsp;
#<a href=https://abskmj.github.io/notes/tags/nodejs/>NodeJS</a>&nbsp;
#<a href=https://abskmj.github.io/notes/tags/npm/>NPM</a>&nbsp;
#<a href=https://abskmj.github.io/notes/tags/tutorial/>Tutorial</a>&nbsp;
#<a href=https://abskmj.github.io/notes/tags/serverless/>Serverless</a>&nbsp;</span><div class=post-content><div><p><a href=https://spotinst.com/products/spotinst-functions/>Spotinst</a> is one of the providers which support deploying serverless functions or FaaS (Function as a Service). <a href=https://serverless.com/>Serverless Framework</a> is an NPM module which makes building serverless applications easy and open.</p><h1 id=isolated-workspace>Isolated Workspace<a href=#isolated-workspace class=hanchor arialabel=Anchor>&#8983;</a></h1><p>The steps listed below is different from the traditional steps listed on the official site. I always like to keep all the NPM modules and related files within the project directory to keep things isolated from other projects. This also allows me to use multiple Spotinst credentials for multiple serverless applications.</p><h1 id=serverless-framework>Serverless Framework<a href=#serverless-framework class=hanchor arialabel=Anchor>&#8983;</a></h1><h2 id=installation>Installation<a href=#installation class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Install the framework globally</p><pre tabindex=0><code>npm install -g serverless
</code></pre><p>Install the Spotinst functions plugin locally.</p><pre tabindex=0><code>npm install --save-dev serverless-spotinst-functions
</code></pre><h2 id=configuration>Configuration<a href=#configuration class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Create a <code>serverless.yml</code> file in the root directory of the project.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># Welcome to Serverless!</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># This file is the main config file for your service.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># It&#39;s very minimal at this point and uses default values.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># You can always add more config options for more control.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># We&#39;ve included some commented out config examples here.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Just uncomment any of them to get that config option.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># For full config options, check the docs:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#    docs.serverless.com</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Happy Coding!</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>service: demo # NOTE</span>: <span style=color:#ae81ff>update this with your service name</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>provider</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>spotinst</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>#stage: &lt;Stage Name&gt;  #Optional. Defaults to &#39;dev&#39;, see https://help.spotinst.com/hc/en-us/articles/115005893409</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>spotinst</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>environment</span>: <span style=color:#ae81ff>env-c0XXbXeb</span> <span style=color:#75715e>#&lt;env-XXXX&gt; Required.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># exclude serverless files that are needed to be deployed</span>
</span></span><span style=display:flex><span><span style=color:#f92672>package</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>exclude</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>.aws/**</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>.config/**</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>.serverlessrc</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>.spotinst/**       </span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>functions</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>hello</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>runtime</span>: <span style=color:#ae81ff>nodejs8.3</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>handler</span>: <span style=color:#ae81ff>handler.main</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>memory</span>: <span style=color:#ae81ff>128</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>timeout</span>: <span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>access</span>: <span style=color:#ae81ff>private</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#    iamRoleConfig:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#      roleId: # role-id</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#    activeVersions:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#        - &#34;version&#34;: &#34;$LATEST&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#          &#34;percentage&#34;: 100.0</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#    cors:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#        enabled: # false by default</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#        origin:  # &#39;*&#39; by default</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#        headers: # &#39;Content-Type,Authorization&#39; by default</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#        methods: # &#39;DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT&#39; by default</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#    cron:  # Setup scheduled trigger with cron expression</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#      active: true</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#      value: &#39;* * * * *&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#    environmentVariables:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#      key: Value</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># extend the framework using plugins listed here:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># https://github.com/serverless/plugins</span>
</span></span><span style=display:flex><span><span style=color:#f92672>plugins</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>serverless-spotinst-functions</span>
</span></span></code></pre></div><h2 id=credentials>Credentials<a href=#credentials class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Save the spotinst credentials for serverless framework.</p><pre tabindex=0><code>HOME=./ serverless config credentials --provider spotinst --token {{your token}}  --account {{your account id}}
</code></pre><ul><li><code>HOME=./</code> sets the home directory as current project directory so that the Spotinst credentials are stored within the project directory instead of <code>~/.spotinst/credentials</code>.</li><li>Spotinst Account ID can be found at <a href=https://console.spotinst.com/#/settings/account/general>https://console.spotinst.com/#/settings/account/general</a></li><li>Spotinst Token can be found at <a href=https://console.spotinst.com/#/settings/tokens/permanent>https://console.spotinst.com/#/settings/tokens/permanent</a></li></ul><h2 id=deployment>Deployment<a href=#deployment class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Add a <code>deploy</code> script to <code>package.json</code> file.</p><pre tabindex=0><code>{
  ...
  &#34;scripts&#34;: {
    ...
    &#34;deploy&#34;: &#34;HOME=./ serverless deploy&#34;
  },
  ...
}
</code></pre><p>Run the script to deploy.</p><pre tabindex=0><code>npm run deploy
</code></pre><h2 id=version-control>Version Control<a href=#version-control class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Some of the serverless directories or files should not be tracked as part of the version control. These can be added to a <code>.gitignore</code> file.</p><pre tabindex=0><code># package directories
node_modules

# serverless directories
.aws
.config
.serverless
.serverlessrc
.spotinst
</code></pre></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://abskmj.github.io/notes/posts/topics/mongoose/mongoose-lean-hydrate/><span class=button__icon>←</span>
<span class=button__text>Lean option and Hydrate method in Mongoose</span>
</a></span><span class="button next"><a href=https://abskmj.github.io/notes/posts/solutions/hackerrank/contests/projecteuler/euler008/><span class=button__text>HackerRank Contest - Project Euler - Largest product in a series</span>
<span class=button__icon>→</span></a></span></div></div><div id=sponsor class=pagination style=display:none><div class=pagination__title><span class=pagination__title-h>Sponsor</span><hr></div><div class=pagination__buttons><a id=sponsor-link href=https://wise.prf.hn/l/rwNWqOE target=_blank><span id=sponsor-text style=white-space:normal>Wise is a cheaper, faster way to send money abroad. Join over 10 million people who get the real exchange rate
with Wise. They’re up to 8x cheaper than banks.</span></a></div></div><script src=//ace-ally.onrender.com/next.js></script><div class=pagination><div class=pagination__title><span class=pagination__title-h>Discuss Post</span><hr></div><div class=pagination__buttons><span class="button next"><a href="https://github.com/abskmj/notes/discussions/new?category=general&label=comment&title=Deploy%20functions%20on%20Spotinst%20using%20Serverless%20Framework"><span class=button__text>Comment</span>
<span class=button__icon>→</span>
</a></span><span class="button next"><a href=https://github.com/abskmj/notes/tree/master/content/posts/tutorials/spotinst/serverless-spotinst-setup.md><span class=button__text>Edit at Github</span>
<span class=button__icon>→</span></a></span></div></div></article></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>&copy; abskmj</span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/notes/bundle.min.js></script></div></body></html>