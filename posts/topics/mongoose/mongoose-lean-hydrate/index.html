<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Lean option and Hydrate method in Mongoose :: Notes</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Lean and Hydrate in Mongoose Lean option on Query Typically, when returning data from the database as an API response, the virtuals/methods available on a mongoose document are unnecessary. Lean option can be set on such queries to return just the data directly from the database. This also improves the overall performance of the API.
 Documents returned from queries with the lean option enabled are plain javascript objects, not MongooseDocuments." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://abskmj.github.io/notes/posts/topics/mongoose/mongoose-lean-hydrate/" />




<link rel="stylesheet" href="https://abskmj.github.io/notes/assets/style.css">

  <link rel="stylesheet" href="https://abskmj.github.io/notes/assets/green.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://abskmj.github.io/notes/img/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="https://github.com/abskmj.png">



<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Lean option and Hydrate method in Mongoose :: Notes">
<meta property="og:description" content="Lean and Hydrate in Mongoose Lean option on Query Typically, when returning data from the database as an API response, the virtuals/methods available on a mongoose document are unnecessary. Lean option can be set on such queries to return just the data directly from the database. This also improves the overall performance of the API.
 Documents returned from queries with the lean option enabled are plain javascript objects, not MongooseDocuments." />
<meta property="og:url" content="https://abskmj.github.io/notes/posts/topics/mongoose/mongoose-lean-hydrate/" />
<meta property="og:site_name" content="Lean option and Hydrate method in Mongoose" />

  
    <meta property="og:image" content="https://github.com/abskmj.png">
  

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2019-03-08 03:09:10 &#43;0000 UTC" />












</head>
<body class="green">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/notes">
  <div class="logo">
    Notes
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="https://github.com/abskmj">Github</a></li>
        
      
        
          <li><a href="https://twitter.com/abskmj">Twitter</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="https://github.com/abskmj">Github</a></li>
      
    
      
        <li><a href="https://twitter.com/abskmj">Twitter</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="https://abskmj.github.io/notes/posts/topics/mongoose/mongoose-lean-hydrate/">Lean option and Hydrate method in Mongoose</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2019-03-08 
      </span>
    
    
  </div>

  
  <span class="post-tags">
    
    #<a href="https://abskmj.github.io/notes/tags/topic/">Topic</a>&nbsp;
    
    #<a href="https://abskmj.github.io/notes/tags/mongoose/">Mongoose</a>&nbsp;
    
    #<a href="https://abskmj.github.io/notes/tags/model/">Model</a>&nbsp;
    
    #<a href="https://abskmj.github.io/notes/tags/query/">Query</a>&nbsp;
    
    #<a href="https://abskmj.github.io/notes/tags/lean/">Lean</a>&nbsp;
    
    #<a href="https://abskmj.github.io/notes/tags/hydrate/">Hydrate</a>&nbsp;
    
  </span>
  

  

  

  <div class="post-content"><div>
        <h1 id="lean-and-hydrate-in-mongoose">Lean and Hydrate in Mongoose<a href="#lean-and-hydrate-in-mongoose" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<h1 id="lean-option-on-query">Lean option on Query<a href="#lean-option-on-query" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>Typically, when returning data from the database as an API response,  the virtuals/methods available on a mongoose document are unnecessary. <a href="https://mongoosejs.com/docs/api.html#query_Query-lean">Lean option</a> can be set on such queries to return just the data directly from the database. This also improves the overall performance of the API.</p>
<blockquote>
<p>Documents returned from queries with the lean option enabled are plain javascript objects, not MongooseDocuments. They have no save method, getters/setters or other Mongoose magic applied.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#a6e22e">async</span> (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
   <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">users</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">User</span>.<span style="color:#a6e22e">find</span>({ <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;active&#39;</span> }).<span style="color:#a6e22e">limit</span>(<span style="color:#ae81ff">10</span>).<span style="color:#a6e22e">lean</span>();
   <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">json</span>(<span style="color:#a6e22e">users</span>);
});
</code></pre></div><h1 id="hydrate-method-on-model">Hydrate method on Model<a href="#hydrate-method-on-model" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>Hydrating is opposite of lean option. <a href="https://mongoosejs.com/docs/api.html#model_Model.hydrate">Hydrate method</a> can be used to initialize a mongoose document from a plain javascript object to get access to its virtuals/methods.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">let</span> <span style="color:#a6e22e">user</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">User</span>.<span style="color:#a6e22e">findOne</span>().<span style="color:#a6e22e">lean</span>();
<span style="color:#66d9ef">let</span> document <span style="color:#f92672">=</span> <span style="color:#a6e22e">User</span>.<span style="color:#a6e22e">hydrate</span>(<span style="color:#a6e22e">user</span>);

<span style="color:#a6e22e">assert</span>(document <span style="color:#66d9ef">instanceof</span> <span style="color:#a6e22e">mongoose</span>.<span style="color:#a6e22e">Document</span>); <span style="color:#75715e">// true
</span></code></pre></div><h1 id="code-repository">Code Repository<a href="#code-repository" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>A working code repository is available at <a href="https://github.com/abskmj/example-mongoose-lean-hydrate">github</a>. Get started in your local environment</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">git clone https://github.com/abskmj/example-mongoose-lean-hydrate.git
cd example-mongoose-lean-hydrate
npm install
npm test
</code></pre></div>
      </div></div>

  
  
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        <span class="button previous">
            <a href="https://abskmj.github.io/notes/posts/tutorials/git/git-stash/">
                <span class="button__icon">←</span>
                <span class="button__text">Working with Git Stash</span>
            </a>
        </span>
        
        
        <span class="button next">
            <a href="https://abskmj.github.io/notes/posts/tutorials/spotinst/serverless-spotinst-setup/">
                <span class="button__text">Deploy functions on Spotinst using Serverless Framework</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">
        <span>&copy; 2017 abskmj</span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="https://abskmj.github.io/notes/assets/main.js"></script>
<script src="https://abskmj.github.io/notes/assets/prism.js"></script>





  
</div>

</body>
</html>
